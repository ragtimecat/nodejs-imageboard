<%- include('./partials/head.ejs') %>

<body>
  <div class="content">
    <form class="login" action="/user/auth" method="POST">
      <label for="login">Login:</label>
      <input type="text" name="login" id="login">
      <label for="password">Password:</label>
      <input type="password" name="password" id="password">
      <input type="submit" value="Login">
    </form>
  </div>
  <!-- <script type="text/javascript" src="/js/authFormValidation"></script> -->
  <script type="text/javascript">
    // const validation = require('../js/authFormValidation');
    const form = document.querySelector('form');
    const loginInput = document.getElementById('login');
    const passwordInput = document.getElementById('password');

    form.addEventListener('submit', e => {
      e.preventDefault();
      const login = loginInput.value;
      const password = passwordInput.value;

      if (login == '') {
        showMessage('error', 'Please enter a login');
      } else if (password == '') {
        showMessage('error', 'Please enter a password');
      } else if (password.length < 5) {
        showMessage('error', 'Password should have atleast 5 characters');
      } else {
        fetch('/user/auth', {
          method: "POST",
          body: JSON.stringify({ login, password })
        })
          .then(async result => {
            result = await result.json();
            console.log(result);
          })
      }
    })
  </script>
</body>